
<html>
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>

    <script>
    var track = false; // Set tracking to false by default
    var startX, startY, endX, endY;
    var svg;

    function trackon() {
        track = true;
        alert("Tracking is now on.");
    }

    function trackoff() {
        track = false;
        startX = null;
        startY = null;
        endX = null;
        endY = null;
        clearLine();
    }

    function trackit(event) {
        if (track && event.buttons === 1) { // Check if the left mouse button is pressed
        $('#valx').remove();
        $('#valy').remove();
        var svg = document.getElementById('table');
        var point = svg.createSVGPoint();
        point.x = event.clientX;
        point.y = event.clientY;
        var ctm = svg.getScreenCTM();
        var svgPoint = point.matrixTransform(ctm.inverse());

        $('<div id="valx">' + svgPoint.x + '</div>').appendTo("#x");
        $('<div id="valy">' + svgPoint.y + '</div>').appendTo("#y");

        if (startX && startY) {
            endX = svgPoint.x;
            endY = svgPoint.y;
            drawLine(startX, startY, endX, endY, true);
        }
        }
    }

    function drawLine(startX, startY, endX, endY, visible) {
        var svgNS = "http://www.w3.org/2000/svg";
        var svg = document.getElementById('table');
        var line = svg.querySelector('line');
        if (!line) {
        line = document.createElementNS(svgNS, 'line');
        line.setAttribute('stroke', 'black');
        line.setAttribute('stroke-width', '5'); // Increased line width
        svg.appendChild(line);
        }
        line.setAttribute('x1', startX);
        line.setAttribute('y1', startY);
        line.setAttribute('x2', endX);
        line.setAttribute('y2', endY);
        line.style.display = visible ? 'inline' : 'none'; // Set line visibility
    }

    function clearLine() {
        var svg = document.getElementById('table');
        var line = svg.querySelector('line');
        if (line) {
        line.parentNode.removeChild(line);
        }
    }

    function startDrawing(event) {
        var target = event.target;
        if (target.tagName === 'circle' && target.getAttribute('fill') === 'WHITE') {
        var svg = document.getElementById('table');
        var point = svg.createSVGPoint();
        point.x = event.clientX;
        point.y = event.clientY;
        var ctm = svg.getScreenCTM();
        var svgPoint = point.matrixTransform(ctm.inverse());

        startX = svgPoint.x;
        startY = svgPoint.y;
        }
    }

    function showVelocities(initialXVelocity, initialYVelocity) {
        alert("Initial X Velocity: " + initialXVelocity + ", Initial Y Velocity: " + initialYVelocity);
        $('<div class="velocity-event">Initial X Velocity: ' + initialXVelocity + '</div>').appendTo("#events");
        $('<div class="velocity-event">Initial Y Velocity: ' + initialYVelocity + '</div>').appendTo("#events");
        if (initialXVelocity !== null && initialYVelocity !== null){
            sendDataToServer(initialXVelocity, initialYVelocity);
        }
    }

    function sendDataToServer(initialXVelocity, initialYVelocity) {
        // Create an object containing the data to send
        console.log("Sending data to server...");
        // Create an object containing the data to send
        var data = {
            initialXVelocity: initialXVelocity,
            initialYVelocity: initialYVelocity,
        };

        console.log("Data:", data);

        // Send an AJAX POST request to the server
        $.ajax({
            type: "POST",
            url: "/data",  // Update this URL with the appropriate endpoint on your server
            data: JSON.stringify(data),
            contentType: "application/json",
            success: function(response) {
                // Handle successful response from the server if needed
                console.log("Data sent successfully:", response);
            },
            error: function(xhr, status, error) {
                // Handle errors if any
                console.error("Error sending data:", error);
            }
        });
    }

    function getSvgAnimation() {
        $.ajax({
        type: "GET",
        url: "/get_svg_anim",
        success: function(response) {
            // Update SVG contents in HTML dynamically
            console.log('SVGs were received successfully:', response.js_svg);
            animateContents(response.js_svg);
        },
        error: function(xhr, status, error) {
            console.error("Error:", error);
        }
    });
    }

    function animateContents(js_svg){
        let currentIndex = 0;
        const interval = 10; // Interval between displaying SVGs in milliseconds
        const animationInterval = setInterval(() => {
            if (currentIndex >= js_svg.length) {
                clearInterval(animationInterval);
                return;
            }

            document.getElementById('overwrite').innerHTML = js_svg[currentIndex];
            currentIndex++;
        }, interval);
    }
    

    function endDrawing(event) {
        var target = event.target;
        if (target.tagName === 'circle' && target.getAttribute('fill') === 'WHITE' && startX && startY) {
        trackit(event);
        startX = null;
        startY = null;
        endX = null;
        endY = null;

        trackit(event);
        startX = null;
        startY = null;
        endX = null;
        endY = null;
        clearLine();
        }
        clearLine();
        var diffX = endX - startX;
        var diffY = endY - startY;

        // Calculate initial x and y velocities
        var initialXVelocity = diffX;
        var initialYVelocity = diffY;

        showVelocities(initialXVelocity, initialYVelocity);
    }

    $(document).ready(function() {
        getSvgAnimation();
    });

    </script>
</head>
<body>
    <div id = "overwrite"></div>
    <h2>Game Name: sd</h2><p>Player 1: ds</p><p>Player 2: sd</p>
                <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
 <svg onmousemove="trackit(event);" onmousedown="startDrawing(event);" onmouseup="endDrawing(event);"id="table" width="700" height="1375" viewBox="-25 -25 1400 2750"
xmlns="http://www.w3.org/2000/svg"
xmlns:xlink="http://www.w3.org/1999/xlink">
<rect width="1350" height="2700" x="0" y="0" fill="#C0D0C0" /><rect width="1400" height="25" x="-25" y="-25" fill="darkgreen" />
<rect width="1400" height="25" x="-25" y="2700" fill="darkgreen" />
 <rect width="25" height="2750" x="-25" y="-25" fill="darkgreen" />
 <rect width="25" height="2750" x="1350" y="-25" fill="darkgreen" />
<circle cx="0" cy="0" r="114" fill="black" />
<circle cx="0" cy="1350" r="114" fill="black" />
<circle cx="0" cy="2700" r="114" fill="black" />
<circle cx="1350" cy="0" r="114" fill="black" />
<circle cx="1350" cy="1350" r="114" fill="black" />
<circle cx="1350" cy="2700" r="114" fill="black" />
<circle cx="675" cy="675" r="28" fill="YELLOW" />
<circle cx="640" cy="623" r="28" fill="BLUE" />
<circle cx="707" cy="621" r="28" fill="RED" />
<circle cx="612" cy="572" r="28" fill="PURPLE" />
<circle cx="735" cy="570" r="28" fill="ORANGE" />
<circle cx="675" cy="568" r="28" fill="BLACK" />
<circle cx="638" cy="518" r="28" fill="GREEN" />
<circle cx="710" cy="517" r="28" fill="BROWN" />
<circle cx="579" cy="519" r="28" fill="LIGHTYELLOW" />
<circle cx="771" cy="519" r="28" fill="LIGHTBLUE" />
<circle cx="675" cy="463" r="28" fill="PINK" />
<circle cx="610" cy="464" r="28" fill="MEDIUMPURPLE" />
<circle cx="738" cy="464" r="28" fill="LIGHTSALMON" />
<circle cx="549" cy="464" r="28" fill="LIGHTGREEN" />
<circle cx="800" cy="465" r="28" fill="SANDYBROWN" />
<circle cx="676" cy="2025" r="28" fill="WHITE" />
</svg>
                
                      
    <button id="b1" onclick="trackon();">Start Drawing</button>
    <button id="b2" onclick="trackoff();">Stop Drawing</button>
    <div id="x">x=</div>
    <div id="y">y=</div>

</body>
</html>                         
                 